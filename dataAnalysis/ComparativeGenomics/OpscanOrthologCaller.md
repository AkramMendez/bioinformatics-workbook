# Opscan Ortholog Calling Tutorial
Opscan is a software that will call orthologs between two sets of genes that is suitable for constructing synteny between species. Opscan is part of a synteny software, that is published [here](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3961402/).

##### Synopsis from Opscan manual
"Fastp then NWS (without end gap penalties) operon search in genome
database starting with an operon file. Can be used with
a genome database instead of an operon in genome versus
genome comparisons.""



### Download the program files
```
#available here http://www.lcqb.upmc.fr/CHROnicle/SynChro.html
wget http://www.lcqb.upmc.fr/CHROnicle/telechargements/SynChro_linux.zip
unzip SynChro_linux.unzip
The relevant program file should be housed here :
~/1SynChro/Opscan/bin/opscan
```

### Create the input files
Opscan uses two files that you will need to create from a predicted protein fasta file of the genes and a gff annotating gene positions in the genome.
```
:Usage of opscan
Opscan [options] -O <operon.db> [<genome.db>]

:Files that need to be created from the gff and and protein fasta for each species
1.  operon.db
2.  genome.db
```

### Acquire your gff and gene fasta.
Sample 1 protein fasta
```
>GPLIN_000192700 transcript_id=GPLIN_000192700 gene_id=GPLIN_000192700
MSGRGRGGGFVPKKRLNISNQIGINESQQMTAIIQKDEQPKKDMQKDEQSKKDIQKDEQS
KKDIQKDELPKKEESKESLEKQPAERLQQQHPPPPIVHHNQKEHHHIVARKQPVVCFYCK
YEGHMLADCEKRMHMEAKKKAAQIVPRVVNYTFRRTTSQERSGGVGAVSAVTVSPNENSS
FDVFTKPYEGGQSEDDDVATGEDDEEKENDVNEEEKKNAEEERGKDGGKEEQKDEEGTGD
EHHRQQKQEQPLKDVVAAGLVNDGQQEQHQRKKATTASSKKPLVVVPLPVPVSTVKAQVQ
LRSKLLSSNSAGGSPAATSPVVVNPRSESSEEEDDEEVVETPEEDNGSCGEEVGGQSKTI
VTSSATASEETAPPKTEGTEGLEKLVQKLNMDEVDTQDEHLQPEKGGGEDELETVSVKVD
GCVEFDSDSSSYYDCSDGEGGGDGRRLKRIVEEDEYYGEHGALLDLEDDEPAVVGLAAEA
VDTKNEGEEPQQEEGAETDSY
>GPLIN_001029200 transcript_id=GPLIN_001029200 gene_id=GPLIN_001029200
MALVNGKCKHFCRLIKCWLHELAIMKMEQKQYIKNFNFVLKLSEFSLSYYEVYKVLEAIL
IESNAASAIITNERPPAVHTFLKQHFISKLYRKSIKLKQYIRLKFGSNMNKVDCAFVHFG
REMERRLEENSFISYPRFSEYVEQMEEEKCGEAPHNQNTQNTTDLGSKQLAMKLFHEPLW
NYARAIQIDSHECKAVLQFADALRP
>GPLIN_001497500 transcript_id=GPLIN_001497500 gene_id=GPLIN_001497500
MVENATVAATTTDFPPTPTGSTPEGPLNRMGNFLAGLVGGEHQQQLQQTTTPGANASDHE
ALSNNDRVANASSTVSANIDAGGIATTVTPPLDNTTSNVFSSTTEMSPSIVEGPEVEVWN
FAEGMDNMTTPSSTSSTTTERPPVPASAAVALNAWAVNLVASAAVVAVVFFRSF
>GPLIN_001590800 transcript_id=GPLIN_001590800 gene_id=GPLIN_001590800
MKGRWRPANSEHAVTEQVVVRDGGRRKKSDERHWGASARGPAERAHGDPQPGHARTSSGA
RSLAPPTGRRSRVCGTLAAIFHLTV
>GPLIN_000513900 transcript_id=GPLIN_000513900 gene_id=GPLIN_000513900
MEEVAASTPTSRDQSQTRHIRHRKGSDHFEPMYNQQLFVNIENSIGGSAHQSTSNLMHSP
KNVFENGQSQLVLELIGTEEEKPRYYSMPPEVQSEPAVIKLMQSGKKLHIYEGHIFVAVK
PRGRDNMDVYKQQHFQHEHRGSGLARILEAQPS
>GPLIN_000179500 transcript_id=GPLIN_000179500 gene_id=GPLIN_000179500
MSDNPKKVEKRLKEIFICDDVLFAVFKFCGPFELGLKVALISDRFDLLVDAHFKSMEWSL
GCLEIHSATDGSGAEIVKCLSNNGQVERRLPIPQEALPDNVIGFKRLEISYMDQSVIEFF
YRIRRLFASNGISLLISTKTNQKRSWEIIWQRIWPLINDNICGLFSLFPYNLERLRRFSP
TILRDCAKLRMIYSNNLFLKLSADDSAGASSEQALAKWLHTPRGDGLPKEFDNSAEPVNF
IIRFWHCYSDDIMPFELKNILTGERLVLRQINDFEWLLVRCRIERDEDKWTEWENKAVEG
DWRQRFAILFRDSAIGDG
>GPLIN_000089400 transcript_id=GPLIN_000089400 gene_id=GPLIN_000089400
MQQWGTSDIWKGLELDEHDCHAYFDGCQTYSCVDENGDQIFVVNSCVPDIGNCTHSDLDS
ICTKDGGTPKCEICYNGLCNKAKIELKKPLLKTVQKPNNPPETGTGGAKDKSSSEENGMT
TGAKNESSSEKNGMTTGAKNESSSEENGTTGAKASSTPAD
>GPLIN_000832600 transcript_id=GPLIN_000832600 gene_id=GPLIN_000832600
MLSNNFSILFVLLLVLIENNFIFAKSTRTPRTTTATASDEELDEIVNSISETPKNDGDDN
LSTSNEIFELGANSPTTNNGKNQYSASSHDSDEQQQQLALPKMRTEGNFTILPPPILTTE
QIDAIARQSAAMITRSALKHSKEIFAKFAPDSWTEALADVPLSTIRCTVRVSTKVRLLQQ
QAFLHEHLSFTLNNENEDDDTEADVISDGSDRETTTTTTTSNSNGGTPFGAEEASEIRSH
DQAAKTINETIRQLPPHVRQTLEEYGKRFKNQSLYLGGAEAVASIKSILVDLLEELKSVT
SEEREQLGDLFPKLRNVVTPLHTPV
>GPLIN_000567000 transcript_id=GPLIN_000567000 gene_id=GPLIN_000567000
MKTNKRQKVSSSEEEFDPNQKGEDYDLFMDNEEREKFDKMTEKEREIEIYKRLEQREIMK
TREKIKKKLEMAAGKKADEEGSSSQKKRKRKISEESNEGNDDEKEDSPSEAGEVDSSSDE
PKESSSSKGPVKAEPDESDGEIDADYHKPSEVANKQSKKKAMAELLSKRRNKRQTEEKRK
KETLKATLDLDEVFGNEDEEGKSASSSSSSTSSSRSSSPDLGKSRSPSPVAKQEIHTRDE
LIRCQLFRRKLAKFVHAPFFAKTVVGCFVRISIGPNKLDGKQVYRVVEVVETAKIYEVEP
NSDIRTNKGFRLKVCDGEPMRVYRLEFISNSHIVESEFLFWLNKLRSTNTPVPTVDFVDR
KRKEIVDALIYNYNESEVNLLIKEKQRFKRQPTNFAFQKAELLKIKVGG
etc.
```
Sample 1 genome gff
```
##gff-version 3
##sequence-region pathogens_Gpal_scaffold_1 1 599721
# Gene gene:GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       gene    32      1060    .       +       .       ID=gene:GPLIN_000000100;Name=GPLIN_000000100;biotype=protein_coding
pathogens_Gpal_scaffold_1       WormBase_imported       mRNA    32      1060    .       +       .       ID=transcript:GPLIN_000000100;Parent=gene:GPLIN_000000100;Name=GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       exon    32      166     .       +       .       ID=exon:GPLIN_000000100.1;Parent=transcript:GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       exon    483     585     .       +       .       ID=exon:GPLIN_000000100.2;Parent=transcript:GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       exon    685     792     .       +       .       ID=exon:GPLIN_000000100.3;Parent=transcript:GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       exon    837     1060    .       +       .       ID=exon:GPLIN_000000100.4;Parent=transcript:GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     32      166     .       +       0       ID=cds:GPLIN_000000100;Parent=transcript:GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     483     585     .       +       0       ID=cds:GPLIN_000000100;Parent=transcript:GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     685     792     .       +       2       ID=cds:GPLIN_000000100;Parent=transcript:GPLIN_000000100
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     837     1060    .       +       2       ID=cds:GPLIN_000000100;Parent=transcript:GPLIN_000000100
###
# Gene gene:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       gene    47003   48028   .       +       .       ID=gene:GPLIN_000000200;Name=GPLIN_000000200;biotype=protein_coding
pathogens_Gpal_scaffold_1       WormBase_imported       mRNA    47003   48028   .       +       .       ID=transcript:GPLIN_000000200;Parent=gene:GPLIN_000000200;Name=GPLIN_000000200;info=method:InterPro accession:IPR012677 description:Nucleotide-binding%2C alpha-beta plait %0Amethod:InterPro accession:IPR015047 description:Domain of unknown function DUF1866
pathogens_Gpal_scaffold_1       WormBase_imported       exon    47003   47013   .       +       .       ID=exon:GPLIN_000000200.1;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       exon    47446   47475   .       +       .       ID=exon:GPLIN_000000200.2;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       exon    47527   47655   .       +       .       ID=exon:GPLIN_000000200.3;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       exon    47711   47888   .       +       .       ID=exon:GPLIN_000000200.4;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       exon    47942   48028   .       +       .       ID=exon:GPLIN_000000200.5;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     47003   47013   .       +       0       ID=cds:GPLIN_000000200;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     47446   47475   .       +       1       ID=cds:GPLIN_000000200;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     47527   47655   .       +       1       ID=cds:GPLIN_000000200;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     47711   47888   .       +       1       ID=cds:GPLIN_000000200;Parent=transcript:GPLIN_000000200
pathogens_Gpal_scaffold_1       WormBase_imported       CDS     47942   48028   .       +       0       ID=cds:GPLIN_000000200;Parent=transcript:GPLIN_000000200
###
# Gene gene:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       gene    48851   67668   .       -       .       ID=gene:GPLIN_000000300;Name=GPLIN_000000300;biotype=protein_coding
pathogens_Gpal_scaffold_1       WormBase_imported       mRNA    48851   67668   .       -       .       ID=transcript:GPLIN_000000300;Parent=gene:GPLIN_000000300;Name=GPLIN_000000300;info=method:InterPro accession:IPR001452 description:SH3 domain %0Amethod:InterPro accession:IPR002017 description:Spectrin repeat %0Amethod:InterPro accession:IPR002048 description:EF-hand domain %0Amethod:InterPro accession:IPR011992 description:EF-hand domain pair %0Amethod:InterPro accession:IPR013315 description:Spectrin alpha chain%2C SH3 domain %0Amethod:InterPro accession:IPR014837 description:EF-hand%2C Ca insensitive %0Amethod:InterPro accession:IPR018159 description:Spectrin/alpha-actinin %0Amethod:InterPro accession:IPR018247 description:EF-Hand 1%2C calcium-binding site
pathogens_Gpal_scaffold_1       WormBase_imported       exon    67540   67668   .       -       .       ID=exon:GPLIN_000000300.1;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    66788   66928   .       -       .       ID=exon:GPLIN_000000300.2;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    66320   66394   .       -       .       ID=exon:GPLIN_000000300.3;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    65702   65926   .       -       .       ID=exon:GPLIN_000000300.4;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    65138   65239   .       -       .       ID=exon:GPLIN_000000300.5;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    64951   65084   .       -       .       ID=exon:GPLIN_000000300.6;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    64486   64675   .       -       .       ID=exon:GPLIN_000000300.7;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    63771   63983   .       -       .       ID=exon:GPLIN_000000300.8;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    63423   63504   .       -       .       ID=exon:GPLIN_000000300.9;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    63059   63231   .       -       .       ID=exon:GPLIN_000000300.10;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    62815   62997   .       -       .       ID=exon:GPLIN_000000300.11;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    62428   62760   .       -       .       ID=exon:GPLIN_000000300.12;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    62027   62096   .       -       .       ID=exon:GPLIN_000000300.13;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    61825   61931   .       -       .       ID=exon:GPLIN_000000300.14;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    61173   61397   .       -       .       ID=exon:GPLIN_000000300.15;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    60831   60998   .       -       .       ID=exon:GPLIN_000000300.16;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    60548   60676   .       -       .       ID=exon:GPLIN_000000300.17;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    60396   60505   .       -       .       ID=exon:GPLIN_000000300.18;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    59946   60017   .       -       .       ID=exon:GPLIN_000000300.19;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    59768   59858   .       -       .       ID=exon:GPLIN_000000300.20;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    59561   59647   .       -       .       ID=exon:GPLIN_000000300.21;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    59294   59428   .       -       .       ID=exon:GPLIN_000000300.22;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    58935   59069   .       -       .       ID=exon:GPLIN_000000300.23;Parent=transcript:GPLIN_000000300
pathogens_Gpal_scaffold_1       WormBase_imported       exon    58749   58892   .       -       .       ID=exon:GPLIN_000000300.24;Parent=transcript:GPLIN_000000300
etc.
```

Sample 2 Protein fasta
```
>g1.t1
CWIQKIADGNEWKREPLVHFAKVVWLDLMRASLIASHCANVIYAGKQTDIDIDHRTIKLRLQEITAHLANWIAKMLEITWPTISRTRAKSAIGDSDIAES
KEAYQSVAEKIKEELGQFGAEKYDYAVIVFPNWTNPEAKAIICEANSCFELIDVKQINVIVVRIEDNETNFELACKANEWFTPRMESIMKNTIRMWWERQ
KELKLSDLANMLKEWLQFYRHLVLIHNWKFFSSAATITLGVTPTFVRSARAEKGFNHKIDPTFAEAEIFHVHMLL
>g2.t1
MAQIVNLISFLTLVISWPNALSSDTEAVKELATQFSSLTSSTWDIVNQLRFVSENAMEFVRAAGAVGAIIGRAVDIEFGPESDEQKAIKELHEFIKTKFE
ALQRHRQQESNAIKHNFIGTDYQNVLKI
>g3.t1
MKHNLVEKCQLPSQEQMERYAAVLELFQKIEQRHLLLLNQNDVILVEKYKSIKSSILAKSAVAPMQDKLNTILNSANSADEVWQALIKLNMDFHYAENTC
WIQSIADGNEWKREPLFHFAQLVCLDLMKMSLIALHCVNIMYAGKAIEHTLRQIELMLQEIASHMADWIAKMLEITWPTISRIYAKSAIGVSPIKESKDG
YQFVAEKIKEELVQFGAEKYDYAVIVFPNWTDPEAMAIISEANSYFELIDVKQINVIVVRIEDNETNFELACKAAEWFTPRIETKMKEAIKMWWDHKRHL
KLSDLADMLKEWLQFYRNLVLVHNWKFFSSAATITLGVTPTFVRSARAEKGFRHKIVPALFDAEIFHVHMLL
>g4.t1
MRAKCRKVRPKKDGDKMPKVMPKKGGDKMPTKWDKTPKNAGQKRMGQNAGKCCAAKKDGQMAKTKCGVGGVPILPREMGQNAGKPCPDDIRTTSVAIRRT
AHGHCMSFDVRDEFFDQSGVGIRFFVLILPRNGTNMMRMETLRETVEVDELIQNNLTIYNRITQRDEPFSRICRRFCTINEPVRLFYDGFKDHQRRVAKH
QQPSHNVQLDYPTSTVFGQRINIQPNFFGIHFANTTSSSSSEASSSNRFTNMDSVEMVVLLYRAERIGGWKDDDISDYEMSISNYFKDKYIGQHIRVLTI
STSYVQVEVDRAGNIIRSYFGFGLAVMILCSLFSNSLSAFFMHQFSIYKLPVAVFACLCPFMASGTALGILFFAGVRHSSILAVTPFLILALGVDDAFLM
IHSWQLASKRRRHEGGRAVMAHDALSVNLAVVDQLAEVLEDTGPAILISTLTNIFADLVGAFLGSEEITLLCIGNIASIIVDFFYQITLFTAVLVICARR
ELISARKRDNNKIHATNSNNLSEDDVKPTKSGGFRHSLERKFNAFKDIYICLISSLLVCIVWAAFLVVCLNALLKFEINLTLKKLFPPDSPLLEIEKYRE
EKVLPFYTTAQLFVNNPGDLSNATRRAHLNGLIDEMEHLKYAYPAESSLYFVRTYEEFLHGDSAGILDAAAEEENAKNGTATNEFDLSELETFLNWPEFR
HWRGLLKYHHTTHPQQEQSAESQGNGTELTLATNRSDGTQLDAMMTTVAYHGDELQDWYNRALMLREWRQVVDKYVPEFNVSVLHDDGLYLDLLETWYGR
GRMGKTIWYGRGEWGNATWYGRGNGDRENGTPINIWQSVVVTLLCMAAICGLFMCNMFVVFVTTCVIASIFIETLGIMALMDMTMDPVVMAAVTISIGFS
VDMPAHVSYHFHAAKWAGTLGGQNVHGIADQSVEHKIRHAFTSVGFPALQASICTCICVLSLAFVKIYTAQVFVRVLCVCIVLCAVHSLFLLPALFTFLD
AICKLFRQFMCQRR
>g5.t1
MNDNDRAISNHRQKQQQQQGGDINGAIVINNFTDQQHQHQQQQRQLINSAIHRRHRRHPRPRHPPLPTVTRRPNRFPPAAPSVSMRSLRVPIAAGPILWW
HIRTKLCSYASS
>g6.t1
MSELYLALQGEQCYYTVPSIHKGFNVKNLPFECPSFSIALEQQLQQIVDFSGCVKAIETWKAEHMYNRTDCLDSVKKAILESIIDAYNIYQNEADRMHRE
NVLHKYSHSIADLCAFVRTWQQRLNHLLGLLQKSDGLCGLEMMNVLFGQWTFQCCINDWRYRTIETALLAGSSAMHQLLVSWLLDAKLAPAALTRWFIRP
KFVPSSDDPNESQLQRPRHSFNNSVLSAAQLTMNGSANALNMSIAANTTTNYQNELCLFEAPPPTADAVIMASATTMTRNSASFFGTTTAGSDAASIGTG
TGTFVVAAAGAVVEDRIGWASQQQLILSVQLDTDVLPAPFYGCEELLNMIMDIGRKVHFLKMLRPAHANNEQQQSLCAQLPTNVWCTPSAIGRMATILRQ
MHAVVSEEMGRELMGRQRLMDHLCLVHGYFFMLRGDFASALEHILFIKTAKTTATKKCATPFSSRKNVSHSTKIAEKCVNDALAMCSPPANVADLMHLLC
GVKLTKREQMKCKIFSEKFMLKSRLREGQRNEFQAVAEFFSTNALRAYKRVFGFVSNLQLQRAQLDYTGQNLLRVVRQRLATRSEYRSSFYSMLIILQKV
RMFLNRLAHYVFEEVLLLESIYIFDKVRATKDPHVLLAGLYPLLSGVLLALFLPSALSKLHESVQQCIRNASDFVGSISKFCVFIEHSDSDVLDALLLAS
TDDDDDGTATNDDRDTNKNISNQHQQDDEDGTDHRHDVLSNGHPHHQQNCNANNDDCCDGIEQRENQPPPSEEEEEGQQQRAQQQQQQAQKVVTYNNTNS
NDNSSANGLRSAAENRNNSRTTDADQQQFHSVVFAISDSNVNFEASVAKLRNDLATLLAECSSSETKSRYFTPYWSKLNALLFHD
>g7.t1
MPWRTFESYTANDQNAQSFLVSLTEFLSPYAEIDQDKAGVSPEELRAAFFRCGGVNAHSWRILVLAAEGDNETTKFIGKLLDFLTAEGTSAPLTNCPPAA
APPNSQLANPPLQHQAGTSQASQFPFSAAIHSQSGLTCRQEVVGGIAGLKTPPDHIYDTISSSSSADDSHSPHKKLSTLPGHIYHTVMTTTSDGSQCSSV
FYDVPPPSSTIPRESVTTTPPPVPQHTSVVRPMSTSSTDGSQRSSVIYDVPPTPPPPVPQHTHGGEKNRKKNETPSPASKCSDAKKKRKETPKKDSDGKN
>g8.t1
MSKRRLRQELQDMVKNPLPEGCTARPLDQRTMNSWTVTIRGRAGTPYANGNFQLSMAFPRDYPFKAPQVTFTTRIFHPNIDTRGKVCLDILQTHWAPTLT
IEKVVISIIVLLNDPNPDNSPINAQAASLYRTDRAEFNRRAREMTLAYAR
>g9.t1
MNSFLFQPKAGAAVPTPQTSAAGGPPGAAEAPLSVKSSEKSGGTKKGPTPNASTMSRSLTYKPHVVSKDLALLQSEPNYGTLAGLDKEIFAKEQQAKGGM
PPPPMGAPQPQQQAPGPAMTPTTDPNYWTLKNLDADIFTKNAPAKPAAAPKAGPAPHGGGGQALTPTTDPNYGTLQNLDAEIFVKK
>g10.t1
MDQLPVTTTEITAAMANDQPLQTVLQFLRNRWPAKSTDSEISPYFPKRDKIFEVDNFLLYEDRVIVPTSLRSRILKALHIAHPGIVRMKELARRHVYWPG
MDSAIEKVVSTCEECQLGQKKPTKASLSPWPTTDKVFQRVHVDFAGPCSDGRQYLILIDSFSKWPEVYRMNTISAYATVFVLRSIIFQLGIPEEIVSDNG
TQFRSAEFATFCKEFGIKHIFTPPFHPQSNGQVERFVDTFKRSMKKMSKGEKDWIEKMLFAYRTTPHVALDGFSPDQLFFSRKLRTKLTLIHPKGEKAEN
FDQNSFKKGQSKYTDKMAQNFDRKHGSKLTNFFPNDHVLLINYRNNKTEWLQGKIVERLHNSLFHLNKICLSQPIPRW
>g11.t1
MYRHNLASAHNFLLCLILIVSAAYYDSSATAAHTIIISVLHHTSSSSVYWGQSAWKFCYAFGAHIDHRKGGFDRVLDLDYIIRAHQAVPNGVRYFANGRL
IKVFSAHAMLIRATPQQH
>g12.t1
MLGLRIPRNSPLLFNCCVSPPKSEFARFHVARSMTSGPSNFRHAFDHLIKSQQRRHYASGAMPKYTYNNRKADAILPDKWGAIFFLACSQSR
>g13.t1
MLGLRIPRNSSLLFNCCVSPPKSEFARFHVARSMISGPSNFRHAFDHLIKSQQRRHYASGAMPKYTYNNRKADALLPDKWGAIVFFGFFGLFIGYPIYGD
etc.
```
Sample 2 genome gff
```
000080K AUGUSTUS        gene    1       3549    0.8     +       .       ID=g1;
000080K AUGUSTUS        mRNA    1       3549    0.8     +       .       ID=g1.t1;Parent=g1
000080K AUGUSTUS        intron  1       355     0.8     +       .       Parent=g1.t1;
000080K AUGUSTUS        CDS     356     449     0.95    +       1       ID=g1.t1.CDS1;Parent=g1.t1
000080K AUGUSTUS        exon    356     449     .       +       .       ID=g1.t1.exon1;Parent=g1.t1;
000080K AUGUSTUS        intron  450     1162    1       +       .       Parent=g1.t1;
000080K AUGUSTUS        CDS     1163    1297    1       +       0       ID=g1.t1.CDS2;Parent=g1.t1
000080K AUGUSTUS        exon    1163    1297    .       +       .       ID=g1.t1.exon2;Parent=g1.t1;
000080K AUGUSTUS        intron  1298    2313    1       +       .       Parent=g1.t1;
000080K AUGUSTUS        CDS     2314    2450    1       +       0       ID=g1.t1.CDS3;Parent=g1.t1
000080K AUGUSTUS        exon    2314    2450    .       +       .       ID=g1.t1.exon3;Parent=g1.t1;
000080K AUGUSTUS        intron  2451    2838    1       +       .       Parent=g1.t1;
000080K AUGUSTUS        CDS     2839    3054    1       +       1       ID=g1.t1.CDS4;Parent=g1.t1
000080K AUGUSTUS        exon    2839    3054    .       +       .       ID=g1.t1.exon4;Parent=g1.t1;
000080K AUGUSTUS        intron  3055    3248    1       +       .       Parent=g1.t1;
000080K AUGUSTUS        CDS     3249    3385    1       +       1       ID=g1.t1.CDS5;Parent=g1.t1
000080K AUGUSTUS        exon    3249    3385    .       +       .       ID=g1.t1.exon5;Parent=g1.t1;
000080K AUGUSTUS        intron  3386    3439    1       +       .       Parent=g1.t1;
000080K AUGUSTUS        CDS     3440    3549    1       +       2       ID=g1.t1.CDS6;Parent=g1.t1
000080K AUGUSTUS        exon    3440    3549    .       +       .       ID=g1.t1.exon6;Parent=g1.t1;
000080K AUGUSTUS        stop_codon      3547    3549    .       +       0       Parent=g1.t1;
000080K AUGUSTUS        gene    9538    11185   0.39    +       .       ID=g2;
000080K AUGUSTUS        mRNA    9538    11185   0.39    +       .       ID=g2.t1;Parent=g2
000080K AUGUSTUS        start_codon     9538    9540    .       +       0       Parent=g2.t1;
000080K AUGUSTUS        CDS     9538    9558    0.98    +       0       ID=g2.t1.CDS1;Parent=g2.t1
000080K AUGUSTUS        exon    9538    9558    .       +       .       ID=g2.t1.exon1;Parent=g2.t1;
000080K AUGUSTUS        intron  9559    9604    0.99    +       .       Parent=g2.t1;
000080K AUGUSTUS        CDS     9605    9653    0.98    +       0       ID=g2.t1.CDS2;Parent=g2.t1
000080K AUGUSTUS        exon    9605    9653    .       +       .       ID=g2.t1.exon2;Parent=g2.t1;
000080K AUGUSTUS        intron  9654    10139   0.99    +       .       Parent=g2.t1;
000080K AUGUSTUS        CDS     10140   10306   0.97    +       2       ID=g2.t1.CDS3;Parent=g2.t1
000080K AUGUSTUS        exon    10140   10306   .       +       .       ID=g2.t1.exon3;Parent=g2.t1;
000080K AUGUSTUS        intron  10307   11035   0.85    +       .       Parent=g2.t1;
000080K AUGUSTUS        CDS     11036   11185   0.39    +       0       ID=g2.t1.CDS4;Parent=g2.t1
000080K AUGUSTUS        exon    11036   11185   .       +       .       ID=g2.t1.exon4;Parent=g2.t1;
000080K AUGUSTUS        stop_codon      11183   11185   .       +       0       Parent=g2.t1;
000080K AUGUSTUS        gene    13004   16505   0.55    +       .       ID=g3;
000080K AUGUSTUS        mRNA    13004   16505   0.55    +       .       ID=g3.t1;Parent=g3
000080K AUGUSTUS        start_codon     13004   13006   .       +       0       Parent=g3.t1;
000080K AUGUSTUS        CDS     13004   13166   0.55    +       0       ID=g3.t1.CDS1;Parent=g3.t1
000080K AUGUSTUS        exon    13004   13166   .       +       .       ID=g3.t1.exon1;Parent=g3.t1;
000080K AUGUSTUS        intron  13167   13250   0.93    +       .       Parent=g3.t1;
000080K AUGUSTUS        CDS     13251   13301   0.93    +       2       ID=g3.t1.CDS2;Parent=g3.t1
000080K AUGUSTUS        exon    13251   13301   .       +       .       ID=g3.t1.exon2;Parent=g3.t1;
000080K AUGUSTUS        intron  13302   13442   0.93    +       .       Parent=g3.t1;
000080K AUGUSTUS        CDS     13443   13524   0.94    +       2       ID=g3.t1.CDS3;Parent=g3.t1
000080K AUGUSTUS        exon    13443   13524   .       +       .       ID=g3.t1.exon3;Parent=g3.t1;
000080K AUGUSTUS        intron  13525   13784   0.96    +       .       Parent=g3.t1;
000080K AUGUSTUS        CDS     13785   13878   0.99    +       1       ID=g3.t1.CDS4;Parent=g3.t1
000080K AUGUSTUS        exon    13785   13878   .       +       .       ID=g3.t1.exon4;Parent=g3.t1;
000080K AUGUSTUS        intron  13879   13943   1       +       .       Parent=g3.t1;
000080K AUGUSTUS        CDS     13944   14072   1       +       0       ID=g3.t1.CDS5;Parent=g3.t1
000080K AUGUSTUS        exon    13944   14072   .       +       .       ID=g3.t1.exon5;Parent=g3.t1;
000080K AUGUSTUS        intron  14073   15000   1       +       .       Parent=g3.t1;
000080K AUGUSTUS        CDS     15001   15137   1       +       0       ID=g3.t1.CDS6;Parent=g3.t1
000080K AUGUSTUS        exon    15001   15137   .       +       .       ID=g3.t1.exon6;Parent=g3.t1;
000080K AUGUSTUS        intron  15138   15394   1       +       .       Parent=g3.t1;
000080K AUGUSTUS        CDS     15395   15610   1       +       1       ID=g3.t1.CDS7;Parent=g3.t1
000080K AUGUSTUS        exon    15395   15610   .       +       .       ID=g3.t1.exon7;Parent=g3.t1;
etc.
```
Because gff and protein names are so variable between species, it is hard to standardize a script to deal with such huge variation in formating and naming schemes.

### The goal is to obtain operon.db and genome.db files that follow this format
```
><gene_name> <place_holder> <start> <end> <strand> <scaffold_name>
MADQQQQQQDDLGPPPDPVMEVPPPKEIKVLESADDIQSRRTEVLDHYAQFQGFATIKRERLEEARQFQYFKRDADELEIWILEKLQTAAEESFRDPTNLQAKIQKHEAFVAEVQAHSNAITKLDKTGNDMIQHDHYEKDTIRKRLDRLHELWDRLFAMLEGKGIKLQQTLKLLQFVRKCDEMLYWIRDKIQFVSSDDLGADLEHVEVMQRKFDEFLKELKSHESRVLDINHEANTLIDEGHPEQQQIHGKRDEVNEAWHKLGTLTSTRGEALFGAQQIQRFYRDIDETLAWMGEKELTLATDDYGRDLNNVQALQRKHEGTERDLAALESKMDKLGSETNRLCQLYPEKSGDIATKMDEAKGRWEALKLGAEQRKRGLDRSYNRHRFMADYRELGEWIKGIQALIQSSELAKDVAGAEALLEQHQEHKGEIEARADSFKQTAETGQRLLDEEDIDNAXXXXXXXXXXXXXXXXXXXXXXNLISFLATGAKLQEANQEQLFNRNIEDVELWLSELEGQLASEDFGKDLVSVQNLQKKLGLVESDYNAHQERIDAIGHQTREFHDTGHFNAPLISKKFDVLQQRFEALREPLQRRKQKLAESLLGHQLFRDIDHELAWIREKEQIAASTNRGRDLVGVQNLIKKQNALHTEIANHEQQMEQVAQSAEQMVQRGHFLAPDIRDKKSQLRDNWRALKTKADKRKQDLQDSLQAHQYLADANEAESWMRDKEPLVGSTDYGKDEDSAESLLKKHRALMSDLEAFNTTIEELRKEAGQCKYQEQLGGQLGKECVVALYEYTEKSPREVSMKKGDVLTLLNASNKDWWKVEVSDRQGFVPAAYVKRIEPGSQHHHQAMAGQPMNTINAKQSQSEDQYKRLLMLGEQRKRKLEEACKAYQLLREANDLAEWIRSRETVASQQEIGQDLEQVEVLQNKFNDFKNDLKANEVRLQEMNQIATRLSQMGQTETAVRIRQQIDDLNARWKALEQKAEERGQQLESAHEVQRFHKDVDETKDWIQEKNETLDSEDFGRDLRSVQALQRKHEGVERDLAALGDKIRALDEKANRLRQTHPEAAEQIYDLQRQLNEQWTTLTQKANRRKDKLLDRPCVSMKKGDVLTLLNASNKDWWKVEVSDRQGFVPAAYVKRIEPGSQHHHQAMAGQPMNTINAKQSQSEDQYKRLLMLGEQRKRKLEEACKAYQLLREANDLAEWIRSRETVASQQEIGQDLEQVEVLQNKFNDFKNDLKANEVRLQEMNQIATRLSQMGQTETAVRIRQQIDDLNARWKALEQKAEERGQQLESAHEVQRFHKDVDETKDWIQEKNETLDSEDFGRDLRSVQALQRKHEGVERDLAALGDKIRALDEKANRLRQTHPEAAEQIYDLQRQLNEQWTTLTQKANRRKDKLLDSYGQCFLKAALIEKRSKLGESQTLQQFSRDAERWRIGWRRSSKSRRRRPTGPTNIQQKHQKQQAFEAELSANADRIATLISAGQNLITAAKCGGGETAVSARLRALNDQWEQLVKTTTEKSHRLKEANKQKTFMAAVKDLEFWLGEVETLLASEDYGRDLASIENLLKKHQLLEADITAHADRVEDMNRQADALLESEQFDQAQIDGRRRNINERYERVKDAANVRRDKLNKAITVHQFLRDIDEEESWIKEKKLLVSSDDYGRDLAGVQNLRRKHRRFDTELATHQPQVQVVRSKGMELMASSEIGVPEIVKRIKALDQSWTHMVELTEDRHKKLQESEEFQNFIGRVEEEEAWLNEKQQILSSPNVGENMAAVQGLLKKHDTFEVDLQMHQQRIDELQRQGEELINAGNHHAKNIGTRMEQLVKHLILVKELAVRRLQKLRDNNAYMQFMWKCDVVESWIGDKEPHVRSTDFGRDLSSVQLLLNKQDTFDNGLNNFEHEGIQRVTELKDQLLEAEHEQSAAIEQRHQAVIQRWQQLLMNSLERRKKLTEAQAHFKNIEDLYLTFAKKASAFNSWFENAEEDLTDPVRCNSLEEIREHSTVGLAQAWDQLDQLAMRMQHNLEQQIQARNQSGVSEEALREFSMMFRHFDREKLGRLDHQQFKSCLRALGYDLPMVDEGQPEPEFQRILDLVDPNRDGYVTLQEFMAFMINKETENVRSSEEIEMAFRALSKEFRPYVIAEELFANLTPEQADYCINRMKPYVDAASGRTIAGALDFEQFVQSVFMN
><gene_name> <place_holder> <start> <end> <strand> <scaffold_name>
VGSAGLLCETGGFCPWLRAVSLRGGAWTSGESCLWSASAACMLVRAGVRQESGLSSHARKLHSSEKEARANLHAPRCLSAMPKFTATFEANTLSELLSQIKGVLAEGNSVGVGAKKPSVGEAGGVAKAGGKAAKRKRLRQQAAAAVVAAKHAKGGDEEAAETSEKQVDPSSTKPPKKDKPHRKSLEGKE
```
sample 1 operon.db file example
```
>GPLIN_000000100 1 32 1060 + 1
VGSAGLLCETGGFCPWLRAVSLRGGAWTSGESCLWSASAACMLVRAGVRQESGLSSHARKLHSSEKEARANLHAPRCLSAMPKFTATFEANTLSELLSQIKGVLAEGNSVGVGAKKPSVGEAGGVAKAGGKAAKRKRLRQQAAAAVVAAKHAKGGDEEAAETSEKQVDPSSTKPPKKDKPHRKSLEGKE
>GPLIN_000000200 1 47003 48028 + 1
MSKAAEPLLKDAIISLGPPNSTIVCAVSGHPTSFPQRLCNAIFSKIYELGITILVSKLEGRFLHVQLGSGMDALMALSMDGVVLGEDLRLEVCLGFAGCWLDLLMADLQCLGVVREIRMRKVMNCLAMGKRLFWTMFRSLISPM
>GPLIN_000000300 1 48851 67668 - 1
MADQQQQQQDDLGPPPDPVMEVPPPKEIKVLESADDIQSRRTEVLDHYAQFQGFATIKRERLEEARQFQYFKRDADELEIWILEKLQTAAEESFRDPTNLQAKIQKHEAFVAEVQAHSNAITKLDKTGNDMIQHDHYEKDTIRKRLDRLHELWDRLFAMLEGKGIKLQQTLKLLQFVRKCDEMLYWIRDKIQFVSSDDLGADLEHVEVMQRKFDEFLKELKSHESRVLDINHEANTLIDEGHPEQQQIHGKRDEVNEAWHKLGTLTSTRGEALFGAQQIQRFYRDIDETLAWMGEKELTLATDDYGRDLNNVQALQRKHEGTERDLAALESKMDKLGSETNRLCQLYPEKSGDIATKMDEAKGRWEALKLGAEQRKRGLDRSYNRHRFMADYRELGEWIKGIQALIQSSELAKDVAGAEALLEQHQEHKGEIEARADSFKQTAETGQRLLDEEDIDNAXXXXXXXXXXXXXXXXXXXXXXNLISFLATGAKLQEANQEQLFNRNIEDVELWLSELEGQLASEDFGKDLVSVQNLQKKLGLVESDYNAHQERIDAIGHQTREFHDTGHFNAPLISKKFDVLQQRFEALREPLQRRKQKLAESLLGHQLFRDIDHELAWIREKEQIAASTNRGRDLVGVQNLIKKQNALHTEIANHEQQMEQVAQSAEQMVQRGHFLAPDIRDKKSQLRDNWRALKTKADKRKQDLQDSLQAHQYLADANEAESWMRDKEPLVGSTDYGKDEDSAESLLKKHRALMSDLEAFNTTIEELRKEAGQCKYQEQLGGQLGKECVVALYEYTEKSPREVSMKKGDVLTLLNASNKDWWKVEVSDRQGFVPAAYVKRIEPGSQHHHQAMAGQPMNTINAKQSQSEDQYKRLLMLGEQRKRKLEEACKAYQLLREANDLAEWIRSRETVASQQEIGQDLEQVEVLQNKFNDFKNDLKANEVRLQEMNQIATRLSQMGQTETAVRIRQQIDDLNARWKALEQKAEERGQQLESAHEVQRFHKDVDETKDWIQEKNETLDSEDFGRDLRSVQALQRKHEGVERDLAALGDKIRALDEKANRLRQTHPEAAEQIYDLQRQLNEQWTTLTQKANRRKDKLLDRPCVSMKKGDVLTLLNASNKDWWKVEVSDRQGFVPAAYVKRIEPGSQHHHQAMAGQPMNTINAKQSQSEDQYKRLLMLGEQRKRKLEEACKAYQLLREANDLAEWIRSRETVASQQEIGQDLEQVEVLQNKFNDFKNDLKANEVRLQEMNQIATRLSQMGQTETAVRIRQQIDDLNARWKALEQKAEERGQQLESAHEVQRFHKDVDETKDWIQEKNETLDSEDFGRDLRSVQALQRKHEGVERDLAALGDKIRALDEKANRLRQTHPEAAEQIYDLQRQLNEQWTTLTQKANRRKDKLLDSYGQCFLKAALIEKRSKLGESQTLQQFSRDAERWRIGWRRSSKSRRRRPTGPTNIQQKHQKQQAFEAELSANADRIATLISAGQNLITAAKCGGGETAVSARLRALNDQWEQLVKTTTEKSHRLKEANKQKTFMAAVKDLEFWLGEVETLLASEDYGRDLASIENLLKKHQLLEADITAHADRVEDMNRQADALLESEQFDQAQIDGRRRNINERYERVKDAANVRRDKLNKAITVHQFLRDIDEEESWIKEKKLLVSSDDYGRDLAGVQNLRRKHRRFDTELATHQPQVQVVRSKGMELMASSEIGVPEIVKRIKALDQSWTHMVELTEDRHKKLQESEEFQNFIGRVEEEEAWLNEKQQILSSPNVGENMAAVQGLLKKHDTFEVDLQMHQQRIDELQRQGEELINAGNHHAKNIGTRMEQLVKHLILVKELAVRRLQKLRDNNAYMQFMWKCDVVESWIGDKEPHVRSTDFGRDLSSVQLLLNKQDTFDNGLNNFEHEGIQRVTELKDQLLEAEHEQSAAIEQRHQAVIQRWQQLLMNSLERRKKLTEAQAHFKNIEDLYLTFAKKASAFNSWFENAEEDLTDPVRCNSLEEIREHSTVGLAQAWDQLDQLAMRMQHNLEQQIQARNQSGVSEEALREFSMMFRHFDREKLGRLDHQQFKSCLRALGYDLPMVDEGQPEPEFQRILDLVDPNRDGYVTLQEFMAFMINKETENVRSSEEIEMAFRALSKEFRPYVIAEELFANLTPEQADYCINRMKPYVDAASGRTIAGALDFEQFVQSVFMN
>GPLIN_000000400 1 70588 74810 - 1
MITTRLSTCHCTFVGGFFRSHRSENFKKINKAVNIKCQPRMPKKLLPVTSELKTHFEILLERFLDQKYSQAYLNLFTLYLKTFKQFTAFSEEQAIEALAKLEDFFTKMSLDSEIQLSDLNAQLLTLLKNYDSDERHSWEVSELEQLALYTKHITGNVSDWIQNELEDAWPDELSRAAKNALGIEQISDPYAYNKTAHIIKDAVSSRGVPGFIYTILVSLDWDPIANFWYKCNPDYCFPVKGFHGINFVVLRHEIGSQQRAEQAEKWFEAQKSAMIKTIRDNDKISDLGSLIRKGAKVRRKLEEFAH
>GPLIN_000000500 1 78641 78993 + 1
MDERFEQSLEGCWFFETAKRMASDFNQVSECLETQFEVREWESEFSGEEDAPLPKMREICSRANLHLMAQDEPSGGKQKSAEVVAAIEDNCF
>GPLIN_000000600 1 82522 85516 + 1
MLINIGFFFVSIKLLFLVNIDKVSSCALTRYDKGGCCKRNVWSEAIVCPRPYEPNCNIFEYNCVGCTYVFDKANACSVRVYCSCFYCCDPKYAESCPDGCRRCILDGIGGCPENVPDINSSSSMPESEAKAWKHFNLIDVDKSGSLSLNEAVEHLGSKPDNGTFAKHLAKNLSWFAEIDRNANNQIEPWEFDRSLIGVNNHTNG
>GPLIN_000000700 1 94711 95835 + 1
MVGRCIRNFLNVQHIICKVQQLQTIRLTFLHQCIKNKCPAAVLSWGVRMASSSSNRPSHRSKLLDDYHNKRTPNLQLTNLGKHVVAFALDPRGSRFIQQKLGRANPTEKAQLVDALKFG
>GPLIN_000000800 1 97433 101788 - 1
MMGQFIRNFLNVQHIICKIQHVQTVRLTFLHQFIKNECPAAVLSWGARMASSSSSSSSKYRPSHRSKLLDDYRNKRTANLQLTDLGDHVVAFALDPQGSRFIEQKLKRANPTEKAQLVDELRGHVLTLSKNLYGNHVIKTALESVDKASQIEIINEITAQVIPLSLDKYGSRVIQSVLEHCTHKRLVLEQLHANVPTLVTDQYGSYVIRHVLEHGLPEEREPIVRSLHENVPTLVTDQYGNFVIQLVIEHGLPEDRERIGDIMKYAQDKFASNIIEKCLIGGTADQKKALFDNVCVGGPKTLQNARQLMTDEFGTHVIQKFFECGTDDQKAQLVDALRGHVLTLALQIYGGPVIQTALKSVDKASQIKIINEITAQVIPLSLDKYGGRVIQCLLEHCAEQQKRPVLEQLHGNVLSLVTDQYGSFVIQHVIEHGRPEDRERIVRSLNGDIMKNTHLHSFCGVIEKCLIFGTTEQKNALIDQVCADDGTGKPPLLQMMKQKFAKDIVQKMLNVADSAHRQKMMFIINNAPIKNTAIRASKSLKQRGRRRNR
>GPLIN_000000900 1 104880 105675 - 1
MLINIGFFFVFIKLLFLVNIDKVSSCTWTLYDDGGCCTHVRVYCSCYYCCDPQYAESCPDGCRRCILDGKGGCPENVPPFFKSIDNSSSSMPESEAKAWKHFNLIDVDKSGSISLNEAVEHLGSKPDNGTFAKHLAKNLSWFAEIDRNANNQIEPWEFDRSLIGVNNQTNG
>GPLIN_000001000 1 109089 109544 + 1
MKNRQSAISGQNLEFRNSVEELCRHIEGTAFHEQCLQSEVVKQKGFIPRHLRPPWLNVSLFDDNQLPEEKALGNGCYACYKGSTASNGVNPDEEYCACSV
>GPLIN_000001100 1 112071 116244 + 1
MMFDWDGASILNETTTAPAFAAEGIGGVLFVVEAYAPASLSQTLSSSSPDIVFTTSRHPLDYDADGDASGSIFPDHSHPLNLAPSLAIGTLLLLLIICCVIGNLFVITAILIERDLRCRPQYYLVFSLAVADLMVGLIVTPLGALSTLRQSWELGVTLCDFWISVDVLVCTSSILHLVAIALDRYWSVTNICYSNNRTPRRIFSMLVVIWVLSLLISLAPQFGLKDENFVTRVREQQICLISQDIAYQVFSTSTAFYIPLFAIILIYYKIMRAAKKRFRRERDRRTVNRTVLEAVPPKASKMLISQNSPMSPPGRHSQPNCANNNMLSAANGQFKVKLKLESVPHQTSNTTSENDEEDKSQLPLTVTEPQNCCKGEMVAETAFTDGSASFDCEKKGKTRSASHQLLAFPRPILKRAVKKSADRAKRWKWDANGRHGTAFTDGSASFDCEKKGKTRSASHQLLAFPRPILKRAVKKKRGPRETVEMGRERKAWRTLAIITGTFIACWLPFFVLSLYRPICINWTHKGQCESIPPLMEQIFNWLGYLNSAVNPIIYTIFSLDFRLAFERILRRIFCRSRCF
>GPLIN_000001200 1 117647 117901 - 1
MKGLSAVFDAFSKKEKGREFEEEFRKNTVPKMSTEKLAEYDKNADGWVTLDEILQQMRVEAQKADKDGDGTISKEEFRQHKLNW
>GPLIN_000001300 1 120537 121071 + 1
MPLIQNYCIFGNRRHSFLLVAIGIILLMAADYGLAMRQQAVAARGQLRCGDRPASGVKVKLWDEDDGPDPDDVLDEAFTDMSGSFQLGGSTRELTNIDPVLKIYHDCDDGIMPGWFNDVQ
>GPLIN_000001400 1 121611 123575 - 1
MSIHRNFINKLSSSPQGMMWWCKTVLPFRHCANVAAAKMQSAHALLPFLHKTAEDEGDVEPIVQHPLVPKWKQAGLRIERNCSDQIFQTIAKEVVDKFGWDNSAYDYGLWNKVFGSNFSMFFALDQNRQPMGCISMALYPQVAHWSMYYVKERYRGHQLGHALTNRSMELAGDRPIFCYGAPNEPKEVAVCKETKEIVGTCQARQLLNRRVGISLFYADRPSIASALLRDVLLQFAGPDPSTKFDTLLYKTPSNNTESVRLFRQLIQNGPVERQVLTPQFSRYALPFPGQRIFSIGDEHVSLI
etc.
```
sample 2 genome.db files example
```
>g1 1 1 3549 + 000080K
CWIQKIADGNEWKREPLVHFAKVVWLDLMRASLIASHCANVIYAGKQTDIDIDHRTIKLRLQEITAHLANWIAKMLEITWPTISRTRAKSAIGDSDIAESKEAYQSVAEKIKEELGQFGAEKYDYAVIVFPNWTNPEAKAIICEANSCFELIDVKQINVIVVRIEDNETNFELACKANEWFTPRMESIMKNTIRMWWERQKELKLSDLANMLKEWLQFYRHLVLIHNWKFFSSAATITLGVTPTFVRSARAEKGFNHKIDPTFAEAEIFHVHMLL
>g2 1 9538 11185 + 000080K
MAQIVNLISFLTLVISWPNALSSDTEAVKELATQFSSLTSSTWDIVNQLRFVSENAMEFVRAAGAVGAIIGRAVDIEFGPESDEQKAIKELHEFIKTKFEALQRHRQQESNAIKHNFIGTDYQNVLKI
>g3 1 13004 16505 + 000080K
MKHNLVEKCQLPSQEQMERYAAVLELFQKIEQRHLLLLNQNDVILVEKYKSIKSSILAKSAVAPMQDKLNTILNSANSADEVWQALIKLNMDFHYAENTCWIQSIADGNEWKREPLFHFAQLVCLDLMKMSLIALHCVNIMYAGKAIEHTLRQIELMLQEIASHMADWIAKMLEITWPTISRIYAKSAIGVSPIKESKDGYQFVAEKIKEELVQFGAEKYDYAVIVFPNWTDPEAMAIISEANSYFELIDVKQINVIVVRIEDNETNFELACKAAEWFTPRIETKMKEAIKMWWDHKRHLKLSDLADMLKEWLQFYRNLVLVHNWKFFSSAATITLGVTPTFVRSARAEKGFRHKIVPALFDAEIFHVHMLL
>g4 1 18036 28551 - 000080K
MRAKCRKVRPKKDGDKMPKVMPKKGGDKMPTKWDKTPKNAGQKRMGQNAGKCCAAKKDGQMAKTKCGVGGVPILPREMGQNAGKPCPDDIRTTSVAIRRTAHGHCMSFDVRDEFFDQSGVGIRFFVLILPRNGTNMMRMETLRETVEVDELIQNNLTIYNRITQRDEPFSRICRRFCTINEPVRLFYDGFKDHQRRVAKHQQPSHNVQLDYPTSTVFGQRINIQPNFFGIHFANTTSSSSSEASSSNRFTNMDSVEMVVLLYRAERIGGWKDDDISDYEMSISNYFKDKYIGQHIRVLTISTSYVQVEVDRAGNIIRSYFGFGLAVMILCSLFSNSLSAFFMHQFSIYKLPVAVFACLCPFMASGTALGILFFAGVRHSSILAVTPFLILALGVDDAFLMIHSWQLASKRRRHEGGRAVMAHDALSVNLAVVDQLAEVLEDTGPAILISTLTNIFADLVGAFLGSEEITLLCIGNIASIIVDFFYQITLFTAVLVICARRELISARKRDNNKIHATNSNNLSEDDVKPTKSGGFRHSLERKFNAFKDIYICLISSLLVCIVWAAFLVVCLNALLKFEINLTLKKLFPPDSPLLEIEKYREEKVLPFYTTAQLFVNNPGDLSNATRRAHLNGLIDEMEHLKYAYPAESSLYFVRTYEEFLHGDSAGILDAAAEEENAKNGTATNEFDLSELETFLNWPEFRHWRGLLKYHHTTHPQQEQSAESQGNGTELTLATNRSDGTQLDAMMTTVAYHGDELQDWYNRALMLREWRQVVDKYVPEFNVSVLHDDGLYLDLLETWYGRGRMGKTIWYGRGEWGNATWYGRGNGDRENGTPINIWQSVVVTLLCMAAICGLFMCNMFVVFVTTCVIASIFIETLGIMALMDMTMDPVVMAAVTISIGFSVDMPAHVSYHFHAAKWAGTLGGQNVHGIADQSVEHKIRHAFTSVGFPALQASICTCICVLSLAFVKIYTAQVFVRVLCVCIVLCAVHSLFLLPALFTFLDAICKLFRQFMCQRR
>g5 1 28658 29461 - 000080K
MNDNDRAISNHRQKQQQQQGGDINGAIVINNFTDQQHQHQQQQRQLINSAIHRRHRRHPRPRHPPLPTVTRRPNRFPPAAPSVSMRSLRVPIAAGPILWWHIRTKLCSYASS
>g6 1 35207 41689 - 000080K
MSELYLALQGEQCYYTVPSIHKGFNVKNLPFECPSFSIALEQQLQQIVDFSGCVKAIETWKAEHMYNRTDCLDSVKKAILESIIDAYNIYQNEADRMHRENVLHKYSHSIADLCAFVRTWQQRLNHLLGLLQKSDGLCGLEMMNVLFGQWTFQCCINDWRYRTIETALLAGSSAMHQLLVSWLLDAKLAPAALTRWFIRPKFVPSSDDPNESQLQRPRHSFNNSVLSAAQLTMNGSANALNMSIAANTTTNYQNELCLFEAPPPTADAVIMASATTMTRNSASFFGTTTAGSDAASIGTGTGTFVVAAAGAVVEDRIGWASQQQLILSVQLDTDVLPAPFYGCEELLNMIMDIGRKVHFLKMLRPAHANNEQQQSLCAQLPTNVWCTPSAIGRMATILRQMHAVVSEEMGRELMGRQRLMDHLCLVHGYFFMLRGDFASALEHILFIKTAKTTATKKCATPFSSRKNVSHSTKIAEKCVNDALAMCSPPANVADLMHLLCGVKLTKREQMKCKIFSEKFMLKSRLREGQRNEFQAVAEFFSTNALRAYKRVFGFVSNLQLQRAQLDYTGQNLLRVVRQRLATRSEYRSSFYSMLIILQKVRMFLNRLAHYVFEEVLLLESIYIFDKVRATKDPHVLLAGLYPLLSGVLLALFLPSALSKLHESVQQCIRNASDFVGSISKFCVFIEHSDSDVLDALLLASTDDDDDGTATNDDRDTNKNISNQHQQDDEDGTDHRHDVLSNGHPHHQQNCNANNDDCCDGIEQRENQPPPSEEEEEGQQQRAQQQQQQAQKVVTYNNTNSNDNSSANGLRSAAENRNNSRTTDADQQQFHSVVFAISDSNVNFEASVAKLRNDLATLLAECSSSETKSRYFTPYWSKLNALLFHD
>g7 1 44048 45876 - 000080K
MPWRTFESYTANDQNAQSFLVSLTEFLSPYAEIDQDKAGVSPEELRAAFFRCGGVNAHSWRILVLAAEGDNETTKFIGKLLDFLTAEGTSAPLTNCPPAAAPPNSQLANPPLQHQAGTSQASQFPFSAAIHSQSGLTCRQEVVGGIAGLKTPPDHIYDTISSSSSADDSHSPHKKLSTLPGHIYHTVMTTTSDGSQCSSVFYDVPPPSSTIPRESVTTTPPPVPQHTSVVRPMSTSSTDGSQRSSVIYDVPPTPPPPVPQHTHGGEKNRKKNETPSPASKCSDAKKKRKETPKKDSDGKN
>g8 1 47386 48400 - 000080K
MSKRRLRQELQDMVKNPLPEGCTARPLDQRTMNSWTVTIRGRAGTPYANGNFQLSMAFPRDYPFKAPQVTFTTRIFHPNIDTRGKVCLDILQTHWAPTLTIEKVVISIIVLLNDPNPDNSPINAQAASLYRTDRAEFNRRAREMTLAYAR
>g9 1 49054 49899 - 000080K
MNSFLFQPKAGAAVPTPQTSAAGGPPGAAEAPLSVKSSEKSGGTKKGPTPNASTMSRSLTYKPHVVSKDLALLQSEPNYGTLAGLDKEIFAKEQQAKGGMPPPPMGAPQPQQQAPGPAMTPTTDPNYWTLKNLDADIFTKNAPAKPAAAPKAGPAPHGGGGQALTPTTDPNYGTLQNLDAEIFVKK
>g10 1 50359 51495 - 000080K
MDQLPVTTTEITAAMANDQPLQTVLQFLRNRWPAKSTDSEISPYFPKRDKIFEVDNFLLYEDRVIVPTSLRSRILKALHIAHPGIVRMKELARRHVYWPGMDSAIEKVVSTCEECQLGQKKPTKASLSPWPTTDKVFQRVHVDFAGPCSDGRQYLILIDSFSKWPEVYRMNTISAYATVFVLRSIIFQLGIPEEIVSDNGTQFRSAEFATFCKEFGIKHIFTPPFHPQSNGQVERFVDTFKRSMKKMSKGEKDWIEKMLFAYRTTPHVALDGFSPDQLFFSRKLRTKLTLIHPKGEKAENFDQNSFKKGQSKYTDKMAQNFDRKHGSKLTNFFPNDHVLLINYRNNKTEWLQGKIVERLHNSLFHLNKICLSQPIPRW
>g11 1 52124 52600 - 000080K
MYRHNLASAHNFLLCLILIVSAAYYDSSATAAHTIIISVLHHTSSSSVYWGQSAWKFCYAFGAHIDHRKGGFDRVLDLDYIIRAHQAVPNGVRYFANGRLIKVFSAHAMLIRATPQQH
>g12 1 54807 55736 - 000080K
MLGLRIPRNSPLLFNCCVSPPKSEFARFHVARSMTSGPSNFRHAFDHLIKSQQRRHYASGAMPKYTYNNRKADAILPDKWGAIFFLACSQSR
>g13 1 56192 57032 - 000080K
MLGLRIPRNSSLLFNCCVSPPKSEFARFHVARSMISGPSNFRHAFDHLIKSQQRRHYASGAMPKYTYNNRKADALLPDKWGAIVFFGFFGLFIGYPIYGDSDATVWWKLEDDNK
>g14 1 57217 58323 + 000080K
MNATDPNYGTLKNLDADIFTKNAPAKPAAAPKAGPAPHGGGGQALTPTTDPNYGTLQNLDAEIFVKK
>g15 1 58977 60035 + 000080K
MSKRRLRQELKDMEKNPLPEGCTARPLDQRTMTPWTVTIRGRAGTPYENGNFQLSMAFPRDYPFKAPQVTFTTRIFHPNIDTRGKVCLDILQTHWAPTLTIEKVVISIIVLLNDPNPDNSPINAQAASLYRTDRAEFNRRAREMTLAYAWRR
>g16 1 61048 62324 + 000080K
MSCLNVYVNIQSPYAEIDQDKAGVSPEELRAAFFRCGGVNAHSWRILVLAAEGDNETTKFIGKLLDFLTAEGTSAPLTNCPPAAAPPNSQLANPPLQHQAGTSQASQFPFSAAIHSQSGLTCRQEVVRGIAGLKTPPDRIYDTISSSSSADDSHSPHKKLSTPPGHIYHTVMSTSSTDGSKRSSVIYDVPPTPPPPVPQHTVLFRVNLAQRDAEEGQRWKELKAFIHLTTHKYIIFLFTLDV
>g17 1 62651 63547 - 000080K
MHLQGSIFVFFAFLLLQFLPFSISDSPILVNNNSAIATRGDEDCSGCKAYKCMDESDAHCGKRGYLIGYGEPNCERFNSKEIYERFNRIGKKFINCTGKCLIHAMEQYILRHKSRGIDCAELKDAGFDSHSVCYMDCNFCEVCKTNKLALLRAYRLRDFFSLEAIRQVIAVANRCGIVKCLFGNKNE
>g18 1 63943 68879 + 000080K
MAVAVADNANSNNNNAVLAIFFGQFGIGLMHTTFMFYYVKVFLNIFQVNEYWFNWSQLLFLIWNAINDPLFGYLQDVGGTWMKDRGKIFTYFGPFLVLSFLITWFPWRSAPNSPPYVEGLHLIVSLFLYDAFFSCIGVAWSALYSDSTRDHRKRVRGIKYAQLASLCSVNVITVTEKMSHSLENFGAFQFICIGMGIISLCCLYMAGHLGGASLRGGGVPLPSGHRLLRAEDDDDGTSDEGGLLGEKEDKLAAIDSDGTDTWQWARVAELTKQLISAKDFQCIVFTNFIHILRSVSHMNFAVIATDILIPQTVLPKGSWQLSAFFAVCTLLPQFIVITNDKFLLRKGTYRVVMYGLLASVCSAFLYALSAMSLSTPLPPLFNILFSEFIEDDKQRYARKNPVSSLVFSLNALFTKPAISIAPVVIVYLLNQNGYELYRSKGHISDQLRVCMARVLFVIPLLLGTVELLAFRHYSLRHKHRPTSALPI
etc.
```
#Code to convert Sample 1 to operon.db
```
#essentially this approach assumes the same naming scheme for genes and proteins, puts each file into single line format, sorts, and pastes together.
paste <( awk '$3=="gene" {print $1,$4,$5,$7,$9}' globodera_pallida.PRJEB123.WBPS7.annotations.gff3 |sed 's/ID=gene://g' |sed 's/;/\t/g' |sed 's/pathogens_Gpal_scaffold_//g' |awk '{print $5,"1",$3,$2,$4,$1}' |less) <(awk '{print $1}'  globodera_pallida.PRJEB123.WBPS7.protein.fa |tr "\n" "\t" |tr ">" "\n" |sed 's/\t/#/1' |sed 's/\t//g' |sed 's/#/\t/g' |sort -k1,1V |sed '/^$/d') |awk '{print ">"$1,$2,$3,$4,$5,$6"\n"$8}' >operon.db
```
#Code to convert sample 2 to genome.db
```
#This uses the same approach, but the protein file includes proteins predicted from alternatively spliced transcripts.  Since primary transcripts are of the most importance and we want to prevent artificial duplication, we will grep "t1" when the fasta file is single lines.
 paste <(awk '$3=="gene" {print $1,$4,$5,$7,$9}' augustus.gff3 |sed 's/ID=//g' |sed 's/;/\t/g' |sed 's/pathogens_Gpal_scaffold_//g' |awk '{print $5,"1",$3,$2,$4,$1}' ) <(awk '{print $1}'  augustus.aa |tr "\n" "\t" |tr ">" "\n" |sed 's/\t/#/1' |sed 's/\t//g' |sed 's/#/\t/g' |grep "t1" |sort -k1,1V ) |awk '{print ">"$1,$2,$3,$4,$5,$6"\n"$8}' |sed '/^$/d' |sed 's/\.t1//g' |less
```
Beware, the code above assumes that the genes are sorted correctly, yours may be different.

### Run opscan
```
#-S no classes computed, -b two or more operon.db genes can be a homolog with a genome.db gene, -C output suboperons in operon genes
./opscan -S -b -C -Q -O operon.db genome.db  >iadhorePlazaTable
```
Sample of the output above
```
CO  List of similar genes with operon GPLIN_000000100:
CO      gene g12170 (score  31.85 dlen ratio  1.17)
CO      gene g27614 (score  31.85 dlen ratio  1.08)
CO      gene g22305 (score  31.21 dlen ratio  1.06)
CO      gene g9207 (score  29.20 dlen ratio  1.02)
CO      gene g25628 (score  28.25 dlen ratio  1.21)
CO      gene g13794 (score  28.05 dlen ratio  1.27)

CO  List of similar genes with operon GPLIN_000000200:
CO      gene g11691 (score  32.56 dlen ratio  1.27)
CO      gene g24814 (score  30.41 dlen ratio  1.08)
CO      gene g15389 (score  29.84 dlen ratio  1.11)
CO      gene g15392 (score  29.38 dlen ratio  1.11)
CO      gene g10490 (score  28.17 dlen ratio  1.25)
CO      gene g10488 (score  28.17 dlen ratio  1.25)

CO  List of similar genes with operon GPLIN_000000300:
CO      gene g16041 (score  70.59 dlen ratio  1.11)
CO      gene g6503 (score  30.20 dlen ratio  1.08)
CO      gene g25240 (score  29.64 dlen ratio  1.07)
CO      gene g14467 (score  26.47 dlen ratio  1.10)
CO      gene g13713 (score  24.66 dlen ratio  1.23)
CO      gene g7023 (score  24.66 dlen ratio  1.23)

CO  List of similar genes with operon GPLIN_000000400:
CO      gene g29333 (score  38.45 dlen ratio  1.24)
CO      gene g25693 (score  29.49 dlen ratio  1.30)
CO      gene g25617 (score  29.02 dlen ratio  1.29)
CO      gene g18315 (score  28.36 dlen ratio  1.27)
CO      gene g11308 (score  27.85 dlen ratio  1.19)
CO      gene g3825 (score  27.27 dlen ratio  1.08)

CO  List of similar genes with operon GPLIN_000000500:
CO      gene g21617 (score  31.30 dlen ratio  1.23)
CO      gene g28038 (score  30.65 dlen ratio  1.23)
CO      gene g5356 (score  29.47 dlen ratio  1.21)
CO      gene g6095 (score  28.57 dlen ratio  1.19)
CO      gene g6092 (score  28.57 dlen ratio  1.19)
CO      gene g27039 (score  28.49 dlen ratio  1.26)

CO  List of similar genes with operon GPLIN_000000600:
CO      gene g1861 (score  47.97 dlen ratio  1.15)
CO      gene g25809 (score  47.68 dlen ratio  1.00)
CO      gene g1868 (score  43.01 dlen ratio  1.10)
CO      gene g25829 (score  41.27 dlen ratio  1.00)
CO      gene g1862 (score  39.47 dlen ratio  1.07)
CO      gene g11644 (score  33.72 dlen ratio  1.07)

CO  List of similar genes with operon GPLIN_000000700:
CO      gene g3508 (score  30.92 dlen ratio  1.22)
CO      gene g25120 (score  29.57 dlen ratio  1.27)
CO      gene g11695 (score  28.33 dlen ratio  1.24)
CO      gene g18323 (score  28.17 dlen ratio  1.28)
CO      gene g17973 (score  28.17 dlen ratio  1.28)
CO      gene g23796 (score  27.60 dlen ratio  1.29)
```
#reformatting the above will generate a one to one ortholog relationship of the top scoring gene in genome.db using the following code:
```
 less iadhorePlazaTable |cut -f 2- |sed 's/CO  List of similar genes with operon //g' |sed 's/://g' |grep -A 1 "GPLIN" |sed 's/--//g' |sed '/^$/d' |awk '{if(NF>1) {print $2} else {print "#"$0}}'|tr "\n" "\t" |tr "#" "\n" |sed '/^$/d' |less
```
#the above code can also be modified to make familes of orthologs

#sample of the output from the code above
```
GPLIN_000000100 g12170
GPLIN_000000200 g11691
GPLIN_000000300 g16041
GPLIN_000000400 g29333
GPLIN_000000500 g21617
GPLIN_000000600 g1861
GPLIN_000000700 g3508
GPLIN_000000800 g17807
GPLIN_000000900 g25809
GPLIN_000001000 g2058
GPLIN_000001100 g17530
GPLIN_000001200 g23779
GPLIN_000001300 g18358
GPLIN_000001400 g5028
GPLIN_000001500 g18095
GPLIN_000001600 g23645
GPLIN_000001700 g25395
GPLIN_000001800 g29162
GPLIN_000001900 g24049
GPLIN_000002000 g10142
GPLIN_000002100 g21109
GPLIN_000002200 g10141
GPLIN_000002300 g24950
GPLIN_000002400 g25562
GPLIN_000002500 g19960
GPLIN_000002600 g10139
GPLIN_000002700 g10574
GPLIN_000002800 g18246
GPLIN_000002900 g18237
GPLIN_000003000 g8285
GPLIN_000003100 g16829
GPLIN_000003200 g28534
GPLIN_000003300 g3532
GPLIN_000003400 g14435
GPLIN_000003500 g19032
GPLIN_000003600 g25157
GPLIN_000003700 g13927
GPLIN_000003800 g4160
etc.
```
